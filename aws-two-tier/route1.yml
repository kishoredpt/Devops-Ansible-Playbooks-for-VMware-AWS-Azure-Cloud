---
- name: Route IGW
  hosts: localhost
  gather_facts: true
  connection: local
  vars:
      region: ap-south-1
      gpname: groupname
      keypair: keypairname
  tasks:
    - name: route IGW
      ec2_vpc_route_table:
        vpc_id: vpc id
        region: ap-south-1
        aws_access_key: your aws access key
        aws_secret_key: your aws secret access key
        subnets: public subnet id
        routes: 
          - dest: 0.0.0.0/0
            gateway_id: igw id
        tags:
          Name: networktest-route
    #update the CIDR address in the SSH port section
    - name: Create security group
      ec2_group: 
        name: app-server
        description: App-Server security group
        vpc_id: vpc id
        region: ap-south-1
        aws_access_key: your aws access key
        aws_secret_key: your aws secret access key
        rules:
          - proto: tcp
            ports: 
            - 80
            cidr_ip: 0.0.0.0/0
          - proto: tcp
            ports:
            - 22
            cidr_ip: 0.0.0.0/0
      register: security_group
